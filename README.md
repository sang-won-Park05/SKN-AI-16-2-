<img src="https://capsule-render.vercel.app/api?type=waving&color=0C356A&height=200&text=SKN%20AI%20캠프%2016기%202차%20프로젝트&fontColor=ffffff&fontSize=50" />

## 📌 SKN-AI-16-2 - 당원 이탈 예측 프로젝트

🧪 본 프로젝트는 **가상**의 당원 데이터를 활용하여,  
머신러닝 ,딥러닝기법을 통해 이탈 여부를 예측하고  
그 과정에서 데이터 분석 및 모델링 전반을 실습하며 학습하는 것을 목표로 하였습니다.

## 👥 팀원 소개

<table>
  <tr align="center">
    <td><img src="https://raw.githubusercontent.com/sang-won-Park05/SKN-AI-16-2-/main/images/김민정.png" width="100"/></td>
    <td><img src="https://raw.githubusercontent.com/sang-won-Park05/SKN-AI-16-2-/main/images/박상원.jpeg" width="100"/></td>
    <td><img src="https://raw.githubusercontent.com/sang-won-Park05/SKN-AI-16-2-/main/images/신희석.png" width="100"/></td>
    <td><img src="https://raw.githubusercontent.com/sang-won-Park05/SKN-AI-16-2-/main/images/안주영.png" width="100"/></td>
    <td><img src="https://raw.githubusercontent.com/sang-won-Park05/SKN-AI-16-2-/main/images/원태식.png" width="100"/></td>
  </tr>
  <tr align="center">
    <td>김민정</td>
    <td>박상원</td>
    <td>신희석</td>
    <td>안주영</td>
    <td>원태식</td>
  </tr>
</table>

## 📅 업무 분담 일정표

| 8월 항목       | 1일(오전) | 1일(오후) | 2일(오전) | 2일(오후) | 3일(오전) | 3일(오후) | 4일(오전) | 4일(오후) | 5일(오전) | 5일(오후) | 6일(오전) |
|----------------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|
| 도메인 분석    | ✅        | ✅        |     ✅       |     ✅       |           |           |           |           |           |           |           |
| 데이터 분석    |           |           | ✅        | ✅        | ✅        |     ✅       |           |           |           |           |           |
| 모델 분석      |           |           |     ✅       |     ✅       | ✅        | ✅        | ✅        |         |         |         |         |
| 설계           |           |           |           |      ✅      |      ✅      |      ✅      |      ✅       |            |            |            |           |
| 개발           |           |           |           |           |           |           |           |     ✅       |      ✅      |     ✅       |           |
| 테스트         |           |           |           |           |           |           |           |           |           |     ✅       |     ✅       |


## 🛠️ 기술 스택

| 구분             | 도구 및 라이브러리 |
|------------------|---------------------|
| 언어             | [![Python](https://img.shields.io/badge/Python-3.10-blue)](https://www.python.org/) |
| 인터페이스       | [![Streamlit](https://img.shields.io/badge/Streamlit-1.35.0-ff4b4b)](https://streamlit.io/) |
| 데이터 처리      | [![pandas](https://img.shields.io/badge/pandas-1.5.3-150458?logo=pandas&logoColor=white)](https://pandas.pydata.org/) [![NumPy](https://img.shields.io/badge/NumPy-1.24.3-013243?logo=numpy&logoColor=white)](https://numpy.org/) |
| 시각화           | [![matplotlib](https://img.shields.io/badge/Matplotlib-3.7.0-11557c?logo=plotly&logoColor=white)](https://matplotlib.org/) [![seaborn](https://img.shields.io/badge/Seaborn-0.12.2-6b92b9)](https://seaborn.pydata.org/) |
| 모델링 (ML) | ![Ridge](https://img.shields.io/badge/RidgeClassifier-sklearn-0c7cd5) ![LogReg](https://img.shields.io/badge/LogisticRegression-sklearn-0c7cd5) ![SGD](https://img.shields.io/badge/SGDClassifier-sklearn-0c7cd5) ![SVC](https://img.shields.io/badge/SVC-sklearn-0c7cd5) ![RF](https://img.shields.io/badge/RandomForest-sklearn-0c7cd5) ![GB](https://img.shields.io/badge/GradientBoosting-sklearn-0c7cd5) ![AdaBoost](https://img.shields.io/badge/AdaBoost-sklearn-0c7cd5) [![XGBoost](https://img.shields.io/badge/XGBoost-1.7-orange)](https://xgboost.readthedocs.io/) [![LightGBM](https://img.shields.io/badge/LightGBM-3.3.5-success)](https://lightgbm.readthedocs.io/) [![CatBoost](https://img.shields.io/badge/CatBoost-1.1-purple)](https://catboost.ai/) |
| 모델링 (DL) | [![MLP_Keras](https://img.shields.io/badge/MLP_Keras-2.11.0-d00000?logo=keras&logoColor=white)](https://keras.io/) [![RNN_Keras](https://img.shields.io/badge/RNN_Keras-2.11.0-d00000?logo=keras&logoColor=white)](https://keras.io/) [![LSTM_Keras](https://img.shields.io/badge/LSTM_Keras-2.11.0-d00000?logo=keras&logoColor=white)](https://keras.io/) |
| 모델링 (Clustering) | [![KMeans](https://img.shields.io/badge/KMeans-sklearn-0c7cd5)](https://scikit-learn.org/stable/modules/generated/sklearn.cluster.KMeans.html) [![MiniSom](https://img.shields.io/badge/MiniSom-2.3.0-lightgrey)](https://github.com/JustGlowing/minisom) |
| 하이퍼파라미터 튜닝 | [![Optuna](https://img.shields.io/badge/Optuna-3.4.0-0e7c7b?logo=optuna)](https://optuna.org/) |
| 기타             | [![SHAP](https://img.shields.io/badge/SHAP-0.43-lightblue)](https://github.com/slundberg/shap) [![joblib](https://img.shields.io/badge/joblib-1.3-lightgrey)](https://joblib.readthedocs.io/) [![pickle](https://img.shields.io/badge/pickle-standard-lightgrey)](https://docs.python.org/3/library/pickle.html) |




## 🔍 프로젝트 필요성 (배경)

조직(정당 또는 커뮤니티)에서는 당원의 유지율이 핵심 운영 지표가 됩니다.
그러나 많은 경우, 당원이 이탈하는 이유는 다양한 변수의 복합적인 영향으로 나타나며,
이를 사전에 예측하기 어렵습니다.
본 프로젝트는 이러한 문제를 데이터 기반으로 접근하여,
이탈 가능성이 높은 당원을 사전에 식별할 수 있는 예측 모델을 개발하고자 합니다.

## 🎯 프로젝트 목표

당원의 다양한 특성(소득, 직업, 가입기간 등)을 기반으로 이탈 여부 예측 모델 구축

머신러닝 기반 모델(CatBoost, XGBoost 등) 간의 성능 비교 및 최적화

피처 중요도 분석을 통해 주요 이탈 요인 도출

분석 결과를 통해 조직 유지율 향상을 위한 인사이트 제공

## 🧹 데이터 전처리 과정

본 프로젝트는 **가상 데이터**를 기반으로 하기 때문에, 일반적인 전처리 절차 중 일부는 생략되었습니다.


## 📄 데이터셋 정보
| No. | Column Name           | Non-Null Count | Dtype  | 설명 (선택)                           |
| --- | --------------------- | -------------- | ------ | --------------------------------- |
| 0   | MemberID              | 10000          | object | 회원 고유 ID                          |
| 1   | Age                   | 10000          | int64  | 나이                                |
| 2   | Gender                | 10000          | object | 성별                                |
| 3   | Region                | 10000          | object | 지역                                |
| 4   | Education             | 10000          | object | 교육 수준                             |
| 5   | Occupation            | 10000          | object | 직업                                |
| 6   | Income\_Decile        | 10000          | int64  | 소득 분위 (1\~10)                     |
| 7   | Income                | 10000          | object | 소득 범주                             |
| 8   | MembershipDuration    | 10000          | int64  | 가입 기간                             |
| 9   | MembershipType        | 10000          | object | 회원 유형                             |
| 10  | Primary\_Support      | 10000          | object | 주요 지지 정책                          |
| 11  | PoliticalActivity     | 10000          | int64  | 정치 활동 수준                          |
| 12  | PartyLoyalty          | 10000          | int64  | 당 충성도                             |
| 13  | PresidentApproval     | 10000          | int64  | 대통령 지지율                           |
| 14  | PolicySatisfaction    | 10000          | int64  | 정책 만족도                            |
| 15  | MediaConsumption      | 10000          | object | 주요 미디어 소비 채널                      |
| 16  | EventImpact           | 10000          | int64  | 특정 이벤트 영향 점수                      |
| 17  | PartyParticipation    | 10000          | int64  | 당 활동 참여 점수                        |
| 18  | FinancialContribution | 10000          | int64  | 정치 후원금                            |
| 19  | Churn                 | 10000          | int64  | 이탈 여부 (1 = 이탈)                    |
| 20  | **Date**              | 10000          | object | **데이터 수집 월 (2024-01 \~ 2025-07)** |


## 📊 수치형 변수 통계 요약
| 변수명                   | count   | mean    | std      | min  | 25%  | 50%  | 75%  | max    |
| --------------------- | ------- | ------- | -------- | ---- | ---- | ---- | ---- | ------ |
| Age                   | 10000.0 | 52.0493 | 16.8700  | 20.0 | 40.0 | 52.0 | 64.0 | 87.0   |
| Income\_Decile        | 10000.0 | 5.2784  | 2.5875   | 1.0  | 3.0  | 5.0  | 7.0  | 10.0   |
| MembershipDuration    | 10000.0 | 58.4032 | 60.4636  | 1.0  | 12.0 | 34.0 | 91.0 | 239.0  |
| PoliticalActivity     | 10000.0 | 2.2028  | 1.1335   | 1.0  | 1.0  | 2.0  | 3.0  | 5.0    |
| PartyLoyalty          | 10000.0 | 3.5716  | 0.8470   | 1.0  | 3.0  | 4.0  | 4.0  | 5.0    |
| PresidentApproval     | 10000.0 | 2.3837  | 1.0874   | 1.0  | 2.0  | 2.0  | 3.0  | 5.0    |
| PolicySatisfaction    | 10000.0 | 3.1481  | 0.7716   | 1.0  | 3.0  | 3.0  | 4.0  | 5.0    |
| EventImpact           | 10000.0 | 3.6861  | 1.0676   | 1.0  | 3.0  | 4.0  | 5.0  | 5.0    |
| PartyParticipation    | 10000.0 | 2.3022  | 1.3004   | 0.0  | 1.0  | 2.0  | 3.0  | 7.0    |
| FinancialContribution | 10000.0 | 54.5811 | 158.5193 | 0.0  | 0.0  | 5.0  | 45.0 | 2700.0 |
| Churn                 | 10000.0 | 0.4925  | 0.5000   | 0.0  | 0.0  | 0.0  | 1.0  | 1.0    |



### 🔹 ERD (Entity Relationship Diagram)

데이터베이스의 테이블 구조 및 변수 간 관계를 시각화한 다이어그램입니다.  
해당 ERD를 통해 어떤 데이터가 중심이 되는지, 어떤 변수들이 연관되어 있는지를 한눈에 파악할 수 있으며,  
모델 설계시 유용하게 활용되었습니다.

![ERD](images/ERD.png)

### 🔹 날짜별 중요 변수 통계
날짜별로 주요 변수(정책 만족도, 충성도, 이벤트 영향 등)의 평균 변화를 분석한 시각화입니다.  
특정 기간에 변수들이 급변한 구간은 이벤트 또는 외부 요인과의 연관성을 시사합니다.

![날짜별 중요변수 통계](images/날짜별_중요변수_통계.png)

### 🔹 상관관계 히트맵 (전체 변수)  
변수 간의 상관관계를 시각적으로 파악하여, Churn에 영향을 미치는 주요 변수들을 선별하는 데 사용했습니다.

### 🔹 Churn과의 개별 변수 상관관계  
Churn과 다른 변수 간의 상관관계를 정렬해 분석한 그래프입니다.  
정책 만족도, 당 충성도, 이벤트 영향도 등이 높은 상관을 보였습니다.

<p align="center">
  <img src="images/상관관계_전체.png" width="48%" />
  <img src="images/Churn과_상관관계.png" width="48%" />
</p>

### 🔹 지역별 이탈률 시각화  
이탈률이 지역별로 얼마나 차이가 나는지를 시각화한 자료입니다.  
지역별 이탈률 차이를 통해 지역 특성을 반영한 전략이 필요함을 인식할 수 있습니다.

<p align="center">
  <img src="images/단계구분도.png" width="48%" />
  <img src="images/거주지역에_따른_이탈률.png" width="48%" />
</p>

### 🔹 Churn 기준 분포 분석 3종
이탈자 기준으로 주요 변수 분포를 시각화한 그래프입니다.  
- 나이 분포: 중장년층(50~65대)의 이탈률이 높음  
- 가입 기간 분포: 가입 초기에 이탈률이 높음  
- 월 당 활동 참여 횟수: 활동 많은 당원은 이탈 확률 낮음

<p align="center">
  <img src="images/churn기준_나이분포.png" width="30%" /><br/>
  <img src="images/churn_기준_가입기간_분포.png" width="30%" style="margin-right: 10px;" />
  <img src="images/churn기준_월_당원_참여횟수_분포.png" width="30%" style="margin-left: 10px;" />
</p>

## 🖥️ Streamlit 기반 고객 이탈 예측 시스템

본 프로젝트는 **Streamlit**을 활용하여 사용자 친화적인 웹 인터페이스에서 고객 세그멘테이션 및 이탈 예측을 수행할 수 있도록 개발된 대시보드입니다.

### ✅ 주요 기능

- CSV 파일 업로드만으로 이탈 확률 예측
- 다양한 머신러닝 모델 선택 및 비교
- 피처 선택 기능 제공
- Optuna 기반 하이퍼파라미터 튜닝 가능
- 예측 결과 저장 및 다운로드
- 예측 히스토리 기록 기능 제공

---

### 🔹 메인 메뉴

예측에 사용된 **모델명**, **선택된 피처 목록**, **하이퍼파라미터 값** 이  
자동으로 기록되는 화면입니다.  

좌측 메뉴에서 피처를 선택하고, 우측에서 모델별 하이퍼파라미터(예: Random Forest, XGBoost, LightGBM 등)를  
직접 조정할 수 있습니다.  
Optuna 기반 하이퍼파라미터 튜닝 기능을 통해 최적화된 모델 설정도 가능합니다.  

이 기능을 활용하면 모델별 설정과 성능을 저장·비교하며,  
최고 성능을 발휘한 조합을 쉽게 재현할 수 있습니다.

<p align="center">
  <img src="images/스트림릿_구현.png" width="80%">
</p>

### 🔹 모델 및 피처 설정 화면

모델 예측 결과를 시각적으로 확인할 수 있는 화면입니다.  
상단에는 Accuracy, Precision, Recall, F1 Score 등 주요 성능 지표가 표시되며,  
하단에는 Confusion Matrix를 통해 예측 클래스별 분포를 직관적으로 파악할 수 있습니다.  

이 화면을 통해 각 고객별 예측 결과와 실제 값(테스트 데이터 시)을 비교하여  
모델의 분류 성능을 상세하게 검증할 수 있습니다.

<p align="center">
  <img src="images/모델예측결과.png" width="80%">
</p>

---

### 🔹 모델 예측 히스토리 화면

업로드한 고객 CSV 데이터를 기반으로 개별 이탈 확률을 예측합니다.  
모델 예측 결과는 테이블 형태로 표시되며, CSV 파일로 저장도 가능합니다.
<p align="center">
  <img src="images/스트림릿_예측.png" width="80%">
</p>

---

### 🔹 고객 세그멘테이션 화면

예측된 고객 데이터를 기반으로 **군집 분석(Clustering)** 및 **세그멘테이션 결과**를 제공하는 화면입니다.  
업로드한 고객 CSV 데이터를 분석하여, 유사한 특성을 가진 고객들을 그룹화하고  
각 그룹별 평균 이탈 확률과 주요 특성을 시각적으로 확인할 수 있습니다.

세그멘테이션별 주요 특징과 평균 이탈 확률을 분석하여, 타겟 마케팅 전략 수립에 활용할 수 있습니다.

<p align="center">
  <img src="images/스트림릿.png" width="80%">
</p>



---
## 📊 모델별 성능 시각화

### 🔹 Random Forest
![랜포](images/랜포.png)

---

### 🔹 CatBoost
![캣부](images/캣부.png)

---

### 🔹 Gradient Boosting
![그라디언트](images/그라디언트.png)

---

### 🔹 Ridge Classifier
![릿지](images/릿지.png)

---

### 🔹 KNN (K=49)
![KNN](images/KNN.png)

---

### 📈 Optuna 튜닝 모델별 성능 비교

- 정확도(Accuracy) 및 ROC Curve를 통해 다양한 모델의 예측 성능을 평가했습니다.

<p align="center">
  <img src="images/모델별_정확도.png" width="48%" />
  <img src="images/모델별_roc.png" width="48%" />
</p>

### 🔍 모델별 중요 변수

각 모델별로 중요한 특성을 분석하여 예측에 영향을 많이 준 변수를 시각화했습니다.

<p align="center">
  <img src="images/모델별_중요변수.png" width="90%" />
</p>

- **CatBoost**: Membership Duration, Event Impact, Age  
- **Gradient Boosting**: President Approval, Party Loyalty, Event Impact  
- **Random Forest**: President Approval, Membership Duration, Event Impact

---

### ✅ 결론

이번 프로젝트에서는 당원의 다양한 특성(소득, 직업, 가입기간 등)을 기반으로 이탈 여부를 예측하는 모델을 구축하였고,  
CatBoost, XGBoost 등 다양한 머신러닝 기반 모델들이나 딥러닝모델을 활용하여 성능을 비교하고 Optuna를 통해 최적화하였습니다.  

또한, 각 모델의 피처 중요도 분석을 통해 **이탈에 영향을 미치는 주요 요인**(ex. 가입 기간, 대통령 지지도 등)을 도출하고,  
이를 통해 조직의 유지율을 높일 수 있는 **실질적인 인사이트**를 제공하였습니다.  

Streamlit 기반 대시보드를 구현하여 분석 결과를 직관적으로 전달하고,  
비전문가도 쉽게 활용할 수 있는 형태로 제공한 점도 큰 성과 중 하나였습니다.

---

### 🧑‍🤝‍🧑 팀원 후기

| 이름     | 후기                                                                 |
|----------|----------------------------------------------------------------------|
| 김민정   | 프로젝트 전반의 기획을 맡으며 흐름을 구성하고 시각화에 기여할 수 있어 의미 있었다. |
| 박상원   | 다양한 모델 실험과 성능 개선에 집중하면서 실무적인 ML 튜닝 역량을 키울 수 있었다. |
| 신희석   | 데이터 전처리와 모델 성능 평가에 주력하며 실제 데이터의 복잡함을 체감한 시간이었다. |
| 안주영   | 이번 프로젝트는 꽤 짜임새 있게 잘 수행했다고 생각한다. 도메인 분석을 통해 고객 이탈에 영향을 주는 피처를 조사했고, 해당 피처를 통해 시뮬레이션을 했다. 프로젝트 고객을 당원 매니저로 정해서 어떻게 하면 업무 자동화를 해줄 수 있을까 고민을 했다. 동적 시각화를 통해 EDA를 확인할 수 있고, 예측 모델을 돌려 히스토리를 확인해서 모델 성능을 빠르게 평가할 수 있게 했다. 그리고 현재 남아 있는 당원을 위험도 높은 순서로 관리할 수 있게 고객 세그멘테이션 기능도 넣었다. 모델을 통해 예측한 것 뿐만아니라 산출물을 통해 솔루션을 제공했다는 점에서 공학적인 측면에서 높은 자체 평가를 내렸다. 아쉬운 점은 시간이 부족해 모델을 돌리면 돌릴 수록 streamlit이 무거워지는 현상이 발생했는데, 세션 초기화를 할 수 있는 기능을 넣었으면 좋았겠다 라는 생각을 했다. 그래도 끝까지 열심히 해준 팀원들에게 너무 감사하다.|
| 원태식   | 모델 성능 비교와 결과 분석을 통해 통계적 사고와 해석력의 중요성을 체감했다. |
